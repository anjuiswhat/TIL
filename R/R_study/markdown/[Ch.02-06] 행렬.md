# [Ch.02-06] 행렬

- R의 행렬(Matrix)은 수학 시간에 배운 행렬의 정의와 같이 행(로우), 열(컬럼)의 수가 지정된 구조다.

- 벡터와 마찬가지로 행렬에는 한 가지 유형의 스칼라만 저장할 수 있다. 따라서 모든 요소가 숫자인 행렬은 가능하지만, ‘1열은 숫자, 2열은 문자열’과 같은 형태는 불가능하다.



## 행렬 생성



### `matrix()` : 행렬을 생성

```R
matrix( 
   data,            # 행렬을 생성할 데이터 벡터 
   nrow,            # 행의 수 
   ncol,            # 열의 수 
   byrow = FALSE,   # TRUE로 설정하면 행우선, FALSE일 경우 열 우선으로 데이터를 채운다.
                    # 생략할 경우 기본값 FALSE 로 자동 적용
   dimnames = NULL  # 행렬의 각 차원에 부여할 이름 
)

-------------------- < example > ------------------------------

> matrix(c(1, 2, 3, 4, 5, 6, 7, 8, 9), nrow=3)
     [,1] [,2] [,3]
[1,]    1    4    7
[2,]    2    5    8
[3,]    3    6    9

> matrix(c(1, 2, 3, 4, 5, 6, 7, 8, 9), ncol=3)
    [,1] [,2] [,3]
[1,]   1    4    7
[2,]   2    5    8
[3,]   3    6    9
```



#### 행렬을 생성하는 배치순서 변경

- `byrow` 옵션을 생략할 경우, 기본값 `FALSE`로 자동 적용되어 행렬 값이 좌측 열부터 채워진다. (열 우선column major).
- 행렬 값을 위쪽 행부터 채우고 싶다면(행 우선row major) `byrow = TRUE`를 지정한다.

```R
> matrix(c(1, 2, 3, 4, 5, 6, 7, 8, 9), nrow=3, byrow=TRUE)
     [,1] [,2] [,3]
[1,]    1    2    3
[2,]    4    5    6
[3,]    7    8    9
```

- 행렬의 행과 열에 명칭을 부여하고 싶다면 dimnames에 리스트로 행, 열의 이름을 지정한다. 리스트 내 첫 번째 벡터는 행의 이름, 두 번째 벡터는 열의 이름이어야 한다.

```R
> matrix(1:9, nrow=3,
         dimnames=list(c("r1", "r2", "r3"), c("c1", "c2", "c3")))
   c1 c2 c3
r1  1  4  7
r2  2  5  8
r3  3  6  9
```



### `dimnames` : 객체의 차원에 이름 부여 및 확인

- 이미 만들어진 행렬에는 `dimnames()<-` 를 사용해 이름을 부여할 수 있다.

```R
dimnames(
   x           # R 객체
) <- value  # 차원에 부여할 이름

-------------------- < example > ------------------------------

> ( x <- matrix(1:9, ncol=3) )
     [,1] [,2] [,3]
[1,]    1    4    7
[2,]    2    5    8
[3,]    3    6    9


# dimnames<- : 객체의 차원에 이름을 설정

> dimnames(x) <- list(c("r1", "r2", "r3"),
                      c("c1", "c2", "c3"))
> x
   c1 c2 c3
r1  1  4  7
r2  2  5  8
r3  3  6  9
```

- 부여한 이름을 반환할 때는 `dimnames()` 함수를 사용한다.

```R
dimnames(
   x  # R 객체 
)

-------------------- < example > ------------------------------

> dimnames(x)
[[1]]
[1] "r1" "r2" "r3"

[[2]]
[1] "c1" "c2" "c3"
```



### `rownames`, `colnames` : 행 또는 열에 이름 부여 및 확인

- `dimnames()`가 행 이름과 열 이름을 한 번에 지정하는 것과 달리 `rownames()`, `colnames()`는 각각 행 이름, 열 이름 지정을 위해 특화된 함수다.

```R
> x <- matrix(1:9, ncol=3)

> rownames(x)  # 아직 행 이름이 없으므로 NULL이 반환됨
NULL


# rownames<- : 행렬의 행 이름을 설정

> rownames(x) <- c("r1", "r2", "r3")
> x
   [,1] [,2] [,3]
r1    1    4    7
r2    2    5    8
r3    3    6    9


# rownames() : 행렬의 행 이름을 가져온다.

> rownames(x)
[1] "r1" "r2" "r3"


# colnames<- : 행렬의 열 이름을 설정

> colnames(x) <- c("c1", "c2", "c3")
> x
   c1 c2 c3
r1  1  4  7
r2  2  5  8
r3  3  6  9


# colnames() : 행렬의 열 이름을 가져온다.

> colnames(x)
[1] "c1" "c2" "c3"
```





## 행렬 데이터 접근

- 행렬은 색인 또는 행과 열의 이름을 통해 접근할 수 있다.



### `A[ridx, cidx]` : 행렬 A의 `ridx`행, `cidx`열에 저장된 값

- 행렬의 각 요소는 `x[ridx, cidx]` 형태로 접근한다. 이때 색인은 벡터의 경우와 마찬가지로 1부터 시작한다.
- 이때 `ridx`나 `cidx`에 벡터를 사용해 여러 값을 지정할 수 있다.
- `ridx`나 `cidx` 중 하나를 생략하면 전체 행 또는 열을 의미함

```R
> ( x <- matrix(c(1, 2, 3, 4, 5, 6, 7, 8, 9), ncol=3) )
     [,1] [,2] [,3]
[1,]    1    4    7
[2,]    2    5    8
[3,]    3    6    9

> x[1,1]
[1] 1

> x[1,2]
[1] 4

> x[2,1]
[1] 2

> x[2,2]
[1] 5
```

- ‘`-색인`’ 형태로 음수를 사용하여 특정 행이나 열을 제외

```R
> x[-3, ]	# x 행렬의 3행을 제거하고 출력
     [,1] [,2] [,3]
[1,]    1    4    7
[2,]    2    5    8
```

- 색인에 벡터를 지정해 여러 값을 한 번에 가져올 수 있다.
- 만약 특정 행이나 열의 전체를 가져오고 싶다면 행이나 열에 아무런 색인도 기재하지 않으면 된다.

```R
> x[1:2, ]	# x 행렬의 1~2행의 데이터를 가져온다.
     [,1] [,2] [,3]
[1,]    1    4    7
[2,]    2    5    8


> x[ ,2:3]	# x 행렬의 2~3열의 데이터를 가져온다.
     [,1] [,2]
[1,]    4    7
[2,]    5    8
[3,]    6    9

> x[2:3, 1:2]	# x 행렬의 2~3행과 1~2열의 데이터를 가져온다.
     [,1] [,2]
[1,]    2    5
[2,]    3    6
```

- 색인에 벡터를 지정하여 특정 행, 열의 값만 추출

```R
> x[c(1, 3), c(1, 3)]	# x 행렬의 1, 3행과 1, 3열의 데이터를 가져온다.
     [,1] [,2]
[1,]    1    7
[2,]    3    9
```



### 행, 열에 부여된 이름을 통한 접근

- 만약 `dimnames`를 통해 행과 열에 이름을 부여했다면 그 이름을 직접 사용할 수도 있다.

```R
> ( x <- matrix(1:9, nrow = 3,
                dimnames = list(c("r1", "r2", "r3"),
                                c("c1", "c2", "c3"))) )
   c1 c2 c3
r1  1  4  7
r2  2  5  8
r3  3  6  9

> x["r1", ]		# r1 이라는 이름을 부여한 첫 번째 행의 모든 열을 출력
c1 c2 c3 
 1  4  7 
```



## 행렬 연산



### 행렬과 스칼라 간의 사칙 연산

```R
> x <- matrix(c(1, 2, 3, 4, 5, 6, 7, 8, 9), nrow=3)

> x * 2
     [,1] [,2] [,3]
[1,]    2    8   14
[2,]    4   10   16
[3,]    6   12   18

> x / 2
     [,1] [,2] [,3]
[1,]  0.5  2.0  3.5
[2,]  1.0  2.5  4.0
[3,]  1.5  3.0  4.5
```



### 행렬 간의 덧셈과 뺄셈

```R
> x <- matrix(c(1, 2, 3, 4, 5, 6, 7, 8, 9), nrow=3)

> x + x
     [,1] [,2] [,3]
[1,]    2    8   14
[2,]    4   10   16
[3,]    6   12   18

> x - x
    [,1] [,2] [,3]
[1,]   0    0    0
[2,]   0    0    0
[3,]   0    0    0
```



### `%*%` : 행렬 간의 곱

```R
> x <- matrix(c(1, 2, 3, 4, 5, 6, 7, 8, 9), nrow=3)

> x
     [,1] [,2] [,3]
[1,]    1    4    7
[2,]    2    5    8
[3,]    3    6    9

> x %*% x
     [,1] [,2] [,3]
[1,]   30   66  102
[2,]   36   81  126
[3,]   42   96  150
```



### `t()` : 전치행렬

- 행렬 또는 데이터 프레임의 전치 행렬을 구한다.

```R
> ( x <- matrix(1:9, nrow=3) )
     [,1] [,2] [,3]
[1,]    1    4    7
[2,]    2    5    8
[3,]    3    6    9

> t(x)	# 행렬 x 의 전치행렬
     [,1] [,2] [,3]
[1,]    1    2    3
[2,]    4    5    6
[3,]    7    8    9
```



### `solve()` :  `a %*% x = b` 일 때, `x`를 계산

- 반환 값은 `a %*% x = b`에서 `x`다.
- `b`를 지정하지 않으면 `a`의 역행렬을 구하게 된다.

```R
solve(
   a,  # 행렬
   b   # 벡터 또는 행렬
)

-------------------- < example > ------------------------------

# 행렬 x의 역행렬을 구한 뒤 x와 곱해 그 결과가 단위행렬(Identity Matrix)이 되는지 확인하는 예

> ( x <- matrix(1:4, ncol=2) )
     [,1] [,2]
[1,]    1    3
[2,]    2    4

> solve(x)	# 행렬 옵션을 하나만 지정했으므로 해당 행렬의 역행렬을 구한다. 
     [,1] [,2]
[1,]   -2  1.5
[2,]    1 -0.5

> x %*% solve(x)	# 해당 행렬과 그 역행렬의 곱이 단위행렬인지 확인
     [,1] [,2]
[1,]    1    0
[2,]    0    1
```



### `nrow()`, `ncol()` : 행, 열의 개수 확인

```R
> (x <- matrix(1:6, ncol=3))
     [,1] [,2] [,3]
[1,]    1    3    5
[2,]    2    4    6

> nrow(x)
[1] 2

> ncol(x)
[1] 3
```



### `dim` : 객체의 차원 수 지정 및 확인

- `dim()`은 행렬 뿐만 아니라 다양한 데이터 타입(예를 들면, 다음 절에서 설명하는 배열)에 적용 가능한 일반(범용)함수 Generic Function 으로, 데이터의 차원을 벡터로 반환한다.
- `dim()`의 반환 값에 새로운 차원을 지정하면 데이터의 차원을 변경할 수 있다는 점이 특이하다.

```R
> ( x <- matrix(1:6, ncol=3) )
     [,1] [,2] [,3]
[1,]    1    3    5
[2,]    2    4    6

> dim(x)	# 행렬 x의 차원 확인
[1] 2 3

> dim(x) <- c(3,2)	# 행렬 x의 차원을 3x2 로 변경

> dim(x)
[1] 3 2

> x
     [,1] [,2]
[1,]    1    4
[2,]    2    5
[3,]    3    6
```

